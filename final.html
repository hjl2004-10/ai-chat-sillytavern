<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open WebUI</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="characters.css">
    <link rel="stylesheet" href="world.css">
    <link rel="stylesheet" href="ai-settings.css">
    <link rel="stylesheet" href="prompt-manager.css">
    <link rel="stylesheet" href="user-persona.css">
</head>
<body>
    
    <!-- 侧边栏 -->
    <div class="sidebar hidden" id="sidebar">
        <div class="sidebar-header">
            <a href="/" class="sidebar-logo">
                <span>Open WebUI</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" width="20" height="20">
                    <rect x="3" y="3" width="18" height="18" rx="5" ry="5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"></rect>
                    <path d="M9.5 21V3" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
            </button>
        </div>
        
        <div class="sidebar-nav">
            <button class="sidebar-nav-item">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path>
                </svg>
                <span>新对话</span>
            </button>
            
            <button class="sidebar-nav-item" onclick="document.getElementById('importFile').click()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"></path>
                </svg>
                <span>导入对话</span>
            </button>
            <input type="file" id="importFile" accept=".jsonl,.json" style="display: none;" onchange="importChat(this.files[0])"  />
            
            <button class="sidebar-nav-item" onclick="showCharacterPanel()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"></path>
                </svg>
                <span>角色卡</span>
            </button>
            
            <button class="sidebar-nav-item" onclick="showWorldBookPanel()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"></path>
                </svg>
                <span>世界书</span>
            </button>
            
            <button class="sidebar-nav-item">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z"></path>
                </svg>
                <span>工作空间</span>
            </button>
        </div>
        
        <div class="sidebar-user">
            <div class="settings-section">
                <div class="setting-item">
                    <label class="setting-label">
                        <span>角色名显示</span>
                        <div class="toggle-switch">
                            <input type="checkbox" id="show-character-header" checked onchange="toggleCharacterHeader(this.checked)">
                            <span class="toggle-slider"></span>
                        </div>
                    </label>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 主内容 -->
    <div class="main-content expanded" id="mainContent">
        <nav class="top-nav">
            <div class="nav-left">
                <button class="menu-toggle show" id="menuToggle" onclick="toggleSidebar()">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" width="20" height="20">
                        <rect x="3" y="3" width="18" height="18" rx="5" ry="5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"></rect>
                        <path d="M9.5 21V3" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                </button>
                
                <button class="model-selector">
                    <span>选择一个模型</span>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path>
                    </svg>
                </button>
            </div>
            
            <div class="top-nav-actions">
                <button class="icon-button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M18.75 12.75h1.5a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM12 6a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 6ZM12 18a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 18ZM3.75 6.75h1.5a.75.75 0 1 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM5.25 18.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 0 1.5ZM3 12a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 3 12ZM9 3.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM12.75 12a2.25 2.25 0 1 1 4.5 0 2.25 2.25 0 0 1-4.5 0ZM9 15.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"></path>
                    </svg>
                </button>
                <button class="icon-button" onclick="showPromptManager()" title="提示词管理器">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13 3v5a2 2 0 002 2h5"></path>
                    </svg>
                </button>
                <button class="icon-button" onclick="showUserPersonaPanel()" title="用户身份管理">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                </button>
            </div>
        </nav>
        
        <div class="chat-container">
            <!-- 角色标题栏 -->
            <div class="chat-header" style="display: none;">
                <div class="chat-header-content">
                    <div class="chat-header-avatar">AI</div>
                    <div class="chat-header-info">
                        <div class="chat-header-name">Default Assistant</div>
                        <div class="chat-header-status">● 在线</div>
                    </div>
                </div>
            </div>
            
            <div class="welcome-section">
                <div class="welcome-title">
                    <span>您好，User</span>
                </div>
                
                <div class="chat-input-wrapper">
                    <div class="chat-input-container">
                        <textarea class="chat-input" placeholder="有什么我能帮您的吗？"></textarea>
                        <div class="chat-input-actions">
                            <div class="input-tools">
                                <button class="input-tool-button">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"></path>
                                    </svg>
                                </button>
                                <div style="width: 1px; height: 16px; background: #e5e7eb; margin: 0 8px;"></div>
                                <button class="input-tool-button">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.75">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="m6.75 7.5 3 2.25-3 2.25m4.5 0h3m-9 8.25h13.5A2.25 2.25 0 0 0 21 18V6a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 6v12a2.25 2.25 0 0 0 2.25 2.25Z"></path>
                                    </svg>
                                    <span>代码解释器</span>
                                </button>
                            </div>
                            <div class="send-buttons">
                                <button class="voice-button">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path>
                                        <path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path>
                                    </svg>
                                </button>
                                <button class="send-button">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 4L12 20" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"></path>
                                        <path d="M8 9L8 15" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"></path>
                                        <path d="M20 10L20 14" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"></path>
                                        <path d="M4 10L4 14" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"></path>
                                        <path d="M16 7L16 17" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="suggestions">
                    <div class="suggestions-header">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"></path>
                        </svg>
                        <span>建议</span>
                    </div>
                    <div class="suggestions-list">
                        <button class="suggestion-item">
                            <div class="suggestion-title">Help me study</div>
                            <div class="suggestion-desc">vocabulary for a college entrance exam</div>
                        </button>
                        <button class="suggestion-item">
                            <div class="suggestion-title">Show me a code snippet</div>
                            <div class="suggestion-desc">of a website's sticky header</div>
                        </button>
                        <button class="suggestion-item">
                            <div class="suggestion-title">Explain options trading</div>
                            <div class="suggestion-desc">if I'm familiar with buying and selling stocks</div>
                        </button>
                        <button class="suggestion-item">
                            <div class="suggestion-title">Give me ideas</div>
                            <div class="suggestion-desc">for what to do with my kids' art</div>
                        </button>
                        <button class="suggestion-item">
                            <div class="suggestion-title">Tell me a fun fact</div>
                            <div class="suggestion-desc">about the Roman Empire</div>
                        </button>
                        <button class="suggestion-item">
                            <div class="suggestion-title">Overcome procrastination</div>
                            <div class="suggestion-desc">give me tips</div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="script.js"></script>
    <script src="characters.js"></script>
    <script src="world.js"></script>
    <script src="world-debug.js"></script>
    <script src="ai-settings.js"></script>
    <script src="prompt-manager.js"></script>
    <script src="user-persona.js"></script>
    <script src="cache-manager.js"></script>
</body>
</html>