# AI 聊天系统部署说明

## 重要更新：路径问题已修复！

之前部署时 data 文件夹会创建在错误的位置（如 C:\Windows\System32\data），现在已修复为始终在程序目录下创建。

## 部署步骤

### 1. 准备文件
将以下文件和文件夹复制到服务器：
```
1前端计划/
├── server.py          # 后端服务器
├── final.html         # 前端页面
├── *.css             # 所有CSS文件
├── *.js              # 所有JS文件
├── requirements.txt   # Python依赖
├── data/             # 数据目录（包含所有子文件夹和文件）
│   ├── characters/   # 角色数据
│   ├── worlds/       # 世界书数据
│   ├── presets/      # 预设数据
│   ├── chats/        # 对话历史
│   └── config.json   # 配置文件
└── logs/             # 日志目录（可选）
```

### 2. 安装Python依赖
```bash
pip install -r requirements.txt
```

### 3. 启动服务器
```bash
python server.py
```

### 4. 访问系统
- 本地访问：http://localhost:5000
- 远程访问：http://服务器IP:5000

## 数据迁移说明

### 从本地迁移到服务器
1. 复制整个 `data` 文件夹到服务器对应目录
2. 确保 `data` 文件夹在 `server.py` 同一目录下
3. 重启服务器即可自动加载所有数据

### 数据文件位置
程序现在会自动在程序所在目录创建和读取 data 文件夹，具体路径为：
- Windows: `程序目录\data\`
- Linux/Mac: `程序目录/data/`

不再会在系统目录（如 System32）创建文件夹了！

## 注意事项
1. **端口冲突**：如果5000端口被占用，可以修改 server.py 最后一行的端口号
2. **防火墙**：确保服务器防火墙开放了5000端口
3. **权限问题**：确保程序有权限在当前目录创建文件和文件夹

## 测试路径是否正确
运行 `test_path.py` 可以查看程序将在哪里创建 data 目录：
```bash
python test_path.py
```

## 常见问题

### Q: data文件夹被创建在错误位置？
A: 已修复！现在使用 `os.path.dirname(os.path.abspath(__file__))` 获取程序所在目录

### Q: 迁移后数据不显示？
A: 检查 data 文件夹是否在 server.py 同一目录下，重启服务器

### Q: 如何备份数据？
A: 直接复制整个 data 文件夹即可完整备份所有数据